### 欧式距离（ED）方法

欧式距离（Euclidean Distance，ED）算法，是利用测序数据寻找混池间存在显著差异标记，并以此评估与性状关联区域的方法。理论上BSA分析构建的两个混池间除了目标性状相关位点存在差异，其他位点均趋向于一致，因此非相关位点的欧式距离即ED值应趋向于0，ED值越大表明该标记在两混池间的差异越大。

ED方法的计算公式如下所示：

$$ED=\sqrt{(A_{mut}-A_{wt})^2+(C_{mut}-C_{wt})^2+(G_{mut}-G_{wt})^2+(T_{mut}-T_{wt})^2}$$

其中，$A_{mut}$为A碱基在突变混池中的频率，$A_{wt}$为A碱基在野生型混池中的频率；$C_{mut}$为C碱基在突变混池中的频率，$C_{wt}$为C碱基在野生型混池中的频率；$G_{mut}$为G碱基在突变混池中的频率，$G_{wt}$为G碱基在野生型混池中的频率；$T_{mut}$为T碱基在突变混池中的频率，$T_{wt}$为T碱基在野生型混池中的频率。

对经过亲本过滤的子代变异位点，首先计算混池间每个位点的ED值。为了降低单一变异位点带来的随机波动，我们取原始ED值的4次方，并采用滑窗方法（`r index_winsize_handle`Mb窗口长度、`r index_stepsize_handle`kb步长）对ED值进行降噪处理。之后以 `r ed_q_handle`% 分位数作为阈值获得候选区间。为了避免标记不均匀带来的误差，同样也要求候选区间内必须包含至少`r gprime_minmarker`个阈值线之上的变异位点。图\@ref(fig:ed-plot)是ED方法的曼哈顿结果图。

> *ED方法的单条染色体的曼哈顿结果图详见结题文件夹目录下[data_release/04.ED](./data_release/04.ED)文件夹下的ED.\*.png/pdf（*代表染色体ID）文件*

```{r ed-plot, fig.cap="ED法的曼哈顿结果图", out.width = "100%"}
include_graphics("../file/ED.png")
```

> **注**：图中的一个点代表一个SNP/InDel标记，横轴为标记的染色体位置信息，纵轴是ED值；图中的黑线表示拟合的曲线，红线表示阈值线。

